<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n Tr·ªã B√°n Gi√†y - Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.3);
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            padding: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 12px;
            font-size: 18px;
            font-weight: bold;
        }

        .logo-icon {
            width: 30px;
            height: 30px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #667eea;
            font-size: 14px;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            color: #666;
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-link:hover {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateX(5px);
        }

        .nav-link.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .welcome-text {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stat-title {
            font-size: 14px;
            color: #666;
            font-weight: 500;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .stat-change {
            font-size: 12px;
            color: #10b981;
            font-weight: 500;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }

        .content-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .card-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .table th {
            background: rgba(102, 126, 234, 0.1);
            font-weight: 600;
            color: #333;
        }

        .table tbody tr:hover {
            background: rgba(102, 126, 234, 0.05);
        }

        .product-image {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            object-fit: cover;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-active {
            background: #dcfce7;
            color: #166534;
        }

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-inactive {
            background: #fecaca;
            color: #991b1b;
        }

        .quick-actions {
            display: grid;
            gap: 10px;
        }

        .quick-action-btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .quick-action-btn:hover {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-2px);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 450px;
            max-height: 85vh;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            position: relative;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .close:hover {
            color: #000;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
        }

        /* Style cho select dropdown */
        .form-input[type="text"], .form-input[type="number"], .form-input[type="email"], select.form-input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
            background-color: white;
        }

        select.form-input {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
            padding-right: 35px;
        }

        select.form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
        }

        select.form-input option {
            padding: 8px;
            font-size: 14px;
        }

        /* Style cho modal form */
        .modal-content h2 {
            margin-bottom: 20px;
            color: #333;
            font-size: 20px;
            text-align: center;
        }

        .modal-content form {
            max-height: calc(85vh - 100px);
            overflow-y: auto;
        }

        .modal-content .btn {
            margin-top: 10px;
            position: sticky;
            bottom: 0;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-content .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: static;
                height: auto;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .content-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                max-width: none;
                margin: 2% auto;
                max-height: 90vh;
                padding: 15px;
            }

            .modal-content form {
                max-height: calc(90vh - 80px);
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <div class="logo-icon">üëü</div>
                <span>Shoe Admin</span>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#dashboard" class="nav-link active" onclick="showSection('dashboard')">
                        <div class="nav-icon">üìä</div>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#products" class="nav-link" onclick="showSection('products')">
                        <div class="nav-icon">üëü</div>
                        <span>S·∫£n ph·∫©m</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#orders" class="nav-link" onclick="showSection('orders')">
                        <div class="nav-icon">üì¶</div>
                        <span>ƒê∆°n h√†ng</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#customers" class="nav-link" onclick="showSection('customers')">
                        <div class="nav-icon">üë•</div>
                        <span>Kh√°ch h√†ng</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#analytics" class="nav-link" onclick="showSection('analytics')">
                        <div class="nav-icon">üìà</div>
                        <span>Th·ªëng k√™</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#inventory" class="nav-link" onclick="showSection('inventory')">
                        <div class="nav-icon">üìã</div>
                        <span>Kho h√†ng</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#banners" class="nav-link" onclick="showSection('banners')">
                        <div class="nav-icon">üñºÔ∏è</div>
                        <span>Banner</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#settings" class="nav-link" onclick="showSection('settings')">
                        <div class="nav-icon">‚öôÔ∏è</div>
                        <span>C√†i ƒë·∫∑t</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#notifications" class="nav-link" onclick="showSection('notifications')">
                        <div class="nav-icon">üîî</div>
                        <span>Th√¥ng b√°o</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-content">
                    <div class="welcome-text">Ch√†o m·ª´ng tr·ªü l·∫°i, Admin!</div>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openModal('addProductModal')">
                            ‚ûï Th√™m s·∫£n ph·∫©m
                        </button>
                        <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">A</div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Section -->
            <div id="dashboard" class="section">
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">T·ªïng doanh thu</div>
                            <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">üí∞</div>
                        </div>
                        <div class="stat-value" id="totalRevenue">0 VND</div>
                        <div class="stat-change">T·ªïng doanh thu t·ª´ t·∫•t c·∫£ ƒë∆°n h√†ng</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">ƒê∆°n h√†ng m·ªõi</div>
                            <div class="stat-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">üÜï</div>
                        </div>
                        <div class="stat-value" id="newOrders">0</div>
                        <div class="stat-change">ƒê∆°n h√†ng ch·ªù x·ª≠ l√Ω</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">T·ªïng s·∫£n ph·∫©m</div>
                            <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">üëü</div>
                        </div>
                        <div class="stat-value" id="totalProducts">0</div>
                        <div class="stat-change">S·∫£n ph·∫©m trong h·ªá th·ªëng</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">T·ªïng kh√°ch h√†ng</div>
                            <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">üë•</div>
                        </div>
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-change">Kh√°ch h√†ng ƒë√£ ƒëƒÉng k√Ω</div>
                    </div>
                </div>

                <!-- Th·ªëng k√™ tr·∫°ng th√°i ƒë∆°n h√†ng -->
                <div class="content-card" style="margin-top: 20px;">
                    <div class="card-title">
                        üìä Th·ªëng k√™ tr·∫°ng th√°i ƒë∆°n h√†ng
                    </div>
                    <div id="orderStatusStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                        <!-- Th·ªëng k√™ s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                    </div>
                </div>

                <!-- Content Grid -->
                <div class="content-grid">
                    <div class="content-card">
                        <div class="card-title">
                            üõçÔ∏è ƒê∆°n h√†ng g·∫ßn ƒë√¢y
                        </div>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>M√£ ƒë∆°n</th>
                                    <th>Kh√°ch h√†ng</th>
                                    <th>S·∫£n ph·∫©m</th>
                                    <th>Gi√° tr·ªã</th>
                                    <th>Tr·∫°ng th√°i</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>#DH001</td>
                                    <td>Nguy·ªÖn VƒÉn A</td>
                                    <td>Nike Air Max 90</td>
                                    <td>2.500.000 VND</td>
                                    <td><span class="status-badge status-active">Ho√†n th√†nh</span></td>
                                </tr>
                                <tr>
                                    <td>#DH002</td>
                                    <td>Tr·∫ßn Th·ªã B</td>
                                    <td>Adidas Ultra Boost</td>
                                    <td>3.200.000 VND</td>
                                    <td><span class="status-badge status-pending">ƒêang giao</span></td>
                                </tr>
                                <tr>
                                    <td>#DH003</td>
                                    <td>L√™ VƒÉn C</td>
                                    <td>Converse Chuck Taylor</td>
                                    <td>1.800.000 VND</td>
                                    <td><span class="status-badge status-active">Ho√†n th√†nh</span></td>
                                </tr>
                                <tr>
                                    <td>#DH004</td>
                                    <td>Ph·∫°m Th·ªã D</td>
                                    <td>Vans Old Skool</td>
                                    <td>2.100.000 VND</td>
                                    <td><span class="status-badge status-pending">Ch·ªù x·ª≠ l√Ω</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="content-card">
                        <div class="card-title">
                            ‚ö° Thao t√°c nhanh
                        </div>
                        <div class="quick-actions">
                            <button class="quick-action-btn" onclick="openModal('addProductModal')">
                                ‚ûï Th√™m s·∫£n ph·∫©m m·ªõi
                            </button>
                            <button class="quick-action-btn" onclick="alert('Xu·∫•t b√°o c√°o doanh thu')">
                                üìä Xu·∫•t b√°o c√°o
                            </button>
                            <button class="quick-action-btn" onclick="alert('Qu·∫£n l√Ω khuy·∫øn m√£i')">
                                üéÅ Qu·∫£n l√Ω khuy·∫øn m√£i
                            </button>
                            <button class="quick-action-btn" onclick="alert('C·∫≠p nh·∫≠t kho h√†ng')">
                                üì¶ C·∫≠p nh·∫≠t kho
                            </button>
                            <button class="quick-action-btn" onclick="alert('Xem ph·∫£n h·ªìi kh√°ch h√†ng')">
                                üí¨ Ph·∫£n h·ªìi kh√°ch h√†ng
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Products Section -->
            <div id="products" class="section" style="display: none;">
                <div class="content-card">
                    <div class="card-title">
                        üëü Qu·∫£n l√Ω s·∫£n ph·∫©m
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>H√¨nh ·∫£nh</th>
                                <th>T√™n s·∫£n ph·∫©m</th>
                                <th>Th∆∞∆°ng hi·ªáu</th>
                                <th>Gi√°</th>
                                <th>ƒê√°nh gi√°</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><div style="width: 40px; height: 40px; background: #f0f0f0; border-radius: 8px; display: flex; align-items: center; justify-content: center;">üëü</div></td>
                                <td>Nike Air Max 90</td>
                                <td>Sneakers</td>
                                <td>2.500.000 VND</td>
                                <td>45</td>
                                <td><span class="status-badge status-active">Ho·∫°t ƒë·ªông</span></td>
                                <td>
                                    <button class="btn" style="background: #10b981; color: white; margin-right: 5px;" onclick="openEditProductModal('${product.id}')">S·ª≠a</button>
                                    <button class="btn" style="background: #ef4444; color: white;" onclick="deleteProduct('${product.id}')">X√≥a</button>
                                    <button class="btn" style="background: #3b82f6; color: white;" onclick="openVariantModal('${product.id}')">Bi·∫øn th·ªÉ</button>
                                </td>
                            </tr>
                            <tr>
                                <td><div style="width: 40px; height: 40px; background: #f0f0f0; border-radius: 8px; display: flex; align-items: center; justify-content: center;">üëü</div></td>
                                <td>Adidas Ultra Boost</td>
                                <td>Running</td>
                                <td>3.200.000 VND</td>
                                <td>32</td>
                                <td><span class="status-badge status-active">Ho·∫°t ƒë·ªông</span></td>
                                <td>
                                    <button class="btn" style="background: #10b981; color: white; margin-right: 5px;" onclick="openEditProductModal('${product.id}')">S·ª≠a</button>
                                    <button class="btn" style="background: #ef4444; color: white;" onclick="deleteProduct('${product.id}')">X√≥a</button>
                                    <button class="btn" style="background: #3b82f6; color: white;" onclick="openVariantModal('${product.id}')">Bi·∫øn th·ªÉ</button>
                                </td>
                            </tr>
                            <tr>
                                <td><div style="width: 40px; height: 40px; background: #f0f0f0; border-radius: 8px; display: flex; align-items: center; justify-content: center;">üëü</div></td>
                                <td>Converse Chuck Taylor</td>
                                <td>Casual</td>
                                <td>1.800.000 VND</td>
                                <td>8</td>
                                <td><span class="status-badge status-pending">S·∫Øp h·∫øt</span></td>
                                <td>
                                    <button class="btn" style="background: #10b981; color: white; margin-right: 5px;" onclick="openEditProductModal('${product.id}')">S·ª≠a</button>
                                    <button class="btn" style="background: #ef4444; color: white;" onclick="deleteProduct('${product.id}')">X√≥a</button>
                                    <button class="btn" style="background: #3b82f6; color: white;" onclick="openVariantModal('${product.id}')">Bi·∫øn th·ªÉ</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Orders Section -->
            <div id="orders" class="section" style="display: none;">
                <div class="content-card">
                    <div class="card-title">
                        üì¶ Qu·∫£n l√Ω ƒë∆°n h√†ng
                    </div>
                    <table class="table" id="ordersTable">
                        <thead>
                            <tr>
                                <th>M√£ ƒë∆°n</th>
                                <th>Kh√°ch h√†ng</th>
                                <th>Ng√†y ƒë·∫∑t</th>
                                <th>T·ªïng ti·ªÅn</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- D·ªØ li·ªáu ƒë∆°n h√†ng s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y b·∫±ng JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Other sections would be implemented similarly -->
            <div id="customers" class="section" style="display: none;">
                <div class="content-card">
                    <div class="card-title">üë• Qu·∫£n l√Ω kh√°ch h√†ng</div>
                    <table class="table" id="userTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>T√™n</th>
                                <th>Email</th>
                                <th>ƒê·ªãa ch·ªâ</th>
                                <th>S·ªë ƒëi·ªán tho·∫°i</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- D·ªØ li·ªáu user s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="analytics" class="section" style="display: none;">
                <div class="content-card">
                    <div class="card-title">üìà Th·ªëng k√™ & B√°o c√°o</div>
                    <p>Bi·ªÉu ƒë·ªì th·ªëng k√™ v√† b√°o c√°o s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y...</p>
                </div>
            </div>

            <div id="inventory" class="section" style="display: none;">
                <div class="content-card">
                    <div class="card-title">üìã Qu·∫£n l√Ω kho h√†ng</div>
                    <button class="btn btn-primary" onclick="openInventoryEditModal()">+ Nh·∫≠p/Xu·∫•t kho</button>
                    <table class="table" id="inventoryTable">
                        <thead>
                            <tr>
                                <th>S·∫£n ph·∫©m</th>
                                <th>M√£ SKU</th>
                                <th>M√†u</th>
                                <th>Size</th>
                                <th>S·ªë l∆∞·ª£ng</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- D·ªØ li·ªáu t·ªìn kho s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y b·∫±ng JS -->
                        </tbody>
                    </table>
                </div>
                <!-- Modal ch·ªânh s·ª≠a t·ªìn kho -->
                <div id="inventoryEditModal" class="modal">
                    <div class="modal-content">
                        <span class="close" onclick="closeModal('inventoryEditModal')">&times;</span>
                        <h2>Ch·ªânh s·ª≠a t·ªìn kho</h2>
                        <form id="inventoryEditForm">
                            <div class="form-group">
                                <label class="form-label">S·∫£n ph·∫©m</label>
                                <input type="text" id="editProductName" class="form-input" readonly>
                            </div>
                            <div class="form-group">
                                <label class="form-label">M√£ SKU</label>
                                <input type="text" id="editSKU" class="form-input" readonly>
                            </div>
                            <div class="form-group">
                                <label class="form-label">M√†u</label>
                                <input type="text" id="editColor" class="form-input" readonly>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Size</label>
                                <input type="text" id="editSize" class="form-input" readonly>
                            </div>
                            <div class="form-group">
                                <label class="form-label">S·ªë l∆∞·ª£ng t·ªìn kho</label>
                                <input type="number" id="editQuantity" class="form-input" min="0" required>
                            </div>
                            <button type="submit" class="btn btn-primary">L∆∞u thay ƒë·ªïi</button>
                        </form>
                    </div>
                </div>
            </div>

            <div id="banners" class="section" style="display: none;">
                <div class="content-card">
                    <div class="card-title">üñºÔ∏è Qu·∫£n l√Ω Banner</div>
                    <button class="btn btn-primary" onclick="openBannerModal()">+ Th√™m banner</button>
                    <table class="table" id="bannerTable">
                        <thead><tr><th>·∫¢nh</th><th>Ti√™u ƒë·ªÅ</th><th>Link</th><th>Thao t√°c</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div id="settings" class="section" style="display: none;">
                <div class="content-card">
                    <div class="card-title">‚öôÔ∏è C√†i ƒë·∫∑t h·ªá th·ªëng</div>
                    <p>C√°c t√πy ch·ªçn c√†i ƒë·∫∑t s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y...</p>
                </div>
            </div>
            <!-- Notifications Section -->
            <div id="notifications" class="section" style="display: none;">
              <div class="content-card">
                <div class="card-title">üîî Qu·∫£n l√Ω Th√¥ng b√°o</div>
                <button class="btn btn-primary" onclick="openNotificationModal()">+ Th√™m th√¥ng b√°o</button>
                <table class="table" id="notificationTable">
                  <thead><tr><th>Ti√™u ƒë·ªÅ</th><th>N·ªôi dung</th><th>Ng∆∞·ªùi nh·∫≠n</th><th>Th·ªùi gian</th><th>Thao t√°c</th></tr></thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
            <!-- Notification Modal -->
            <div id="notificationModal" class="modal">
              <div class="modal-content">
                <span class="close" onclick="closeModal('notificationModal')">&times;</span>
                <h2 id="notificationModalTitle">Th√™m th√¥ng b√°o</h2>
                <form id="notificationForm">
                  <div class="form-group"><label class="form-label">Ti√™u ƒë·ªÅ</label><input type="text" class="form-input" name="title" required></div>
                  <div class="form-group"><label class="form-label">N·ªôi dung</label><textarea class="form-input" name="content" required></textarea></div>
                  <div class="form-group"><label class="form-label">Ng∆∞·ªùi nh·∫≠n (ID, ƒë·ªÉ tr·ªëng g·ª≠i to√†n b·ªô)</label><input type="number" class="form-input" name="userId"></div>
                  <button type="submit" class="btn btn-primary">L∆∞u</button>
                </form>
              </div>
            </div>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div id="addProductModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addProductModal')">&times;</span>
            <h2>Th√™m s·∫£n ph·∫©m m·ªõi</h2>
            <form id="addProductForm">
                <div class="form-group">
                    <label class="form-label">T√™n s·∫£n ph·∫©m</label>
                    <input type="text" class="form-input" placeholder="Nh·∫≠p t√™n s·∫£n ph·∫©m" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Danh m·ª•c</label>
                    <select class="form-input" required>
                        <option value="">Ch·ªçn danh m·ª•c</option>
                        <option value="sneakers">Sneakers</option>
                        <option value="running">Running</option>
                        <option value="casual">Casual</option>
                        <option value="sport">Sport</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Gi√° (VND)</label>
                    <input type="number" class="form-input" placeholder="Nh·∫≠p gi√° s·∫£n ph·∫©m" required>
                </div>
                <div class="form-group">
                    <label class="form-label">S·ªë l∆∞·ª£ng t·ªìn kho</label>
                    <input type="number" class="form-input" placeholder="Nh·∫≠p s·ªë l∆∞·ª£ng" required>
                </div>
                <div class="form-group">
                    <label class="form-label">M√¥ t·∫£</label>
                    <textarea class="form-input" rows="4" placeholder="Nh·∫≠p m√¥ t·∫£ s·∫£n ph·∫©m"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">·∫¢nh s·∫£n ph·∫©m (c√≥ th·ªÉ nh·∫≠p nhi·ªÅu link, m·ªói link 1 √¥)</label>
                    <div id="images-list">
                        <input type="text" class="form-input image-input" placeholder="Link ·∫£nh 1" required>
                    </div>
                    <button type="button" class="btn btn-primary" style="margin-top:8px;" onclick="addImageInput()">+ Th√™m ·∫£nh</button>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Th√™m s·∫£n ph·∫©m</button>
            </form>
        </div>
    </div>

    <!-- Banner Modal -->
    <div id="bannerModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('bannerModal')">&times;</span>
            <h2 id="bannerModalTitle">Th√™m banner</h2>
            <form id="bannerForm">
                <div class="form-group"><label class="form-label">Ti√™u ƒë·ªÅ</label><input type="text" class="form-input" name="title" required></div>
                <div class="form-group"><label class="form-label">Link</label><input type="text" class="form-input" name="link" required></div>
                <div class="form-group"><label class="form-label">·∫¢nh (URL)</label><input type="text" class="form-input" name="image" required></div>
                <button type="submit" class="btn btn-primary">L∆∞u</button>
            </form>
        </div>
    </div>

    <script>
        // Navigation
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.style.display = 'none';
            });
            
            // Show selected section
            document.getElementById(sectionId).style.display = 'block';
            
            // Update active nav link
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.classList.remove('active');
            });
            
            // Add active class to clicked link
            const activeLink = document.querySelector(`a[href="#${sectionId}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
        }

        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Form submission
        function addImageInput() {
            const div = document.createElement('div');
            div.innerHTML = '<input type="text" class="form-input image-input" placeholder="Link ·∫£nh">';
            document.getElementById('images-list').appendChild(div);
        }

        document.getElementById('addProductForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const imageInputs = document.querySelectorAll('.image-input');
            const images = Array.from(imageInputs).map(input => input.value).filter(Boolean);
            alert('S·∫£n ph·∫©m ƒë√£ ƒë∆∞·ª£c th√™m th√†nh c√¥ng!');
            closeModal('addProductModal');
            this.reset();
        });

        // Sample data animation on page load
        window.addEventListener('load', function() {
            // Animate stat cards
            const statCards = document.querySelectorAll('.stat-card');
            statCards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                    card.style.transition = 'all 0.5s ease';
                    setTimeout(() => {
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, 100);
                }, index * 100);
            });
        });

        // Real-time clock
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('vi-VN');
            const dateString = now.toLocaleDateString('vi-VN');
            
            // You can add this to header if needed
            console.log(`${dateString} ${timeString}`);
        }

        setInterval(updateTime, 1000);

        // Sample notification system
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                background: ${type === 'success' ? '#10b981' : '#ef4444'};
                color: white;
                border-radius: 8px;
                z-index: 1001;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Add CSS animation for notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
        `;
        document.head.appendChild(style);

        // Sample data refresh
        function refreshData() {
            showNotification('D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t!');
            
            // Simulate data update
            const statValues = document.querySelectorAll('.stat-value');
            statValues.forEach(value => {
                const currentValue = parseFloat(value.textContent.replace(/[^\d.]/g, ''));
                const newValue = currentValue + Math.floor(Math.random() * 10);
                value.textContent = value.textContent.replace(currentValue.toString(), newValue.toString());
            });
        }

        // Auto refresh every 5 minutes
        setInterval(refreshData, 300000);

        // H√†m fetch v√† render danh s√°ch user
        function fetchAndRenderUsers() {
            fetch('http://192.168.1.6:4000/users')
                .then(res => res.json())
                .then(users => {
                    const tbody = document.querySelector('#userTable tbody');
                    tbody.innerHTML = '';
                    users.forEach(user => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${user.id}</td>
                            <td>${user.name || ''}</td>
                            <td>${user.email || ''}</td>
                            <td>${user.address || ''}</td>
                            <td>${user.phone || ''}</td>
                        `;
                        tbody.appendChild(tr);
                    });
                });
        }

        // G·ªçi h√†m n√†y m·ªói khi v√†o tab kh√°ch h√†ng
        const customerTab = document.querySelector('a[href="#customers"]');
        if (customerTab) {
            customerTab.addEventListener('click', fetchAndRenderUsers);
        }

        // ========== CRUD S·∫¢N PH·∫®M & BI·∫æN TH·ªÇ ========== //
        // API URL
        const API_URL = 'http://192.168.1.6:4000';

        // Hi·ªÉn th·ªã danh s√°ch s·∫£n ph·∫©m
        function fetchAndRenderProducts() {
            fetch(`${API_URL}/products`)
                .then(res => res.json())
                .then(products => {
                    const tbody = document.querySelector('#products .table tbody');
                    tbody.innerHTML = '';
                    products.forEach(product => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td><img src="${product.image && product.image.startsWith('http') ? product.image : 'https://via.placeholder.com/40'}" class="product-image" onerror="this.src='https://via.placeholder.com/40'"/></td>
                            <td>${product.name}</td>
                            <td>${product.brand || ''}</td>
                            <td>${product.price ? product.price.toLocaleString() + ' VND' : '-'}</td>
                            <td>${product.rating ? product.rating + ' ‚≠ê' : '-'}</td>
                            <td><span class="status-badge status-active">Ho·∫°t ƒë·ªông</span></td>
                            <td>
                                <button class="btn" style="background: #10b981; color: white; margin-right: 5px;" onclick="openEditProductModal('${product.id}')">S·ª≠a</button>
                                <button class="btn" style="background: #ef4444; color: white;" onclick="deleteProduct('${product.id}')">X√≥a</button>
                                <button class="btn" style="background: #3b82f6; color: white;" onclick="openVariantModal('${product.id}')">Bi·∫øn th·ªÉ</button>
                            </td>
                        `;
                        tbody.appendChild(tr);
                    });
                });
        }

        // G·ªçi khi v√†o tab s·∫£n ph·∫©m
        const productTab = document.querySelector('a[href="#products"]');
        if (productTab) {
            productTab.addEventListener('click', fetchAndRenderProducts);
        }

        // X√≥a s·∫£n ph·∫©m v√† c√°c bi·∫øn th·ªÉ li√™n quan
        function deleteProduct(productId) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m n√†y?')) return;
            fetch(`${API_URL}/products/${productId}`, { method: 'DELETE' })
                .then(() => {
                    // X√≥a bi·∫øn th·ªÉ li√™n quan
                    fetch(`${API_URL}/variants?productId=${productId}`)
                        .then(res => res.json())
                        .then(variants => {
                            variants.forEach(variant => {
                                fetch(`${API_URL}/variants/${variant.id}`, { method: 'DELETE' });
                            });
                        });
                    fetchAndRenderProducts();
                    showNotification('ƒê√£ x√≥a s·∫£n ph·∫©m!', 'success');
                });
        }

        // ========== Modal ƒë·ªông th√™m/s·ª≠a s·∫£n ph·∫©m & bi·∫øn th·ªÉ ========== //
        // Hi·ªán modal th√™m s·∫£n ph·∫©m
        function openAddProductModal() {
            showProductModal({});
        }
        // Hi·ªán modal s·ª≠a s·∫£n ph·∫©m
        function openEditProductModal(productId) {
            fetch(`${API_URL}/products/${productId}`)
                .then(res => res.json())
                .then(product => {
                    showProductModal(product);
                });
        }
        // Hi·ªán modal qu·∫£n l√Ω bi·∫øn th·ªÉ
        function openVariantModal(productId) {
            fetch(`${API_URL}/products/${productId}`)
                .then(res => res.json())
                .then(product => {
                    fetch(`${API_URL}/variants?productId=${productId}`)
                        .then(res => res.json())
                        .then(variants => {
                            showVariantModal(product, variants);
                        });
                });
        }
        // T·∫°o modal ƒë·ªông cho th√™m/s·ª≠a s·∫£n ph·∫©m
        function showProductModal(product) {
            // X√≥a modal c≈© n·∫øu c√≥
            let oldModal = document.getElementById('dynamicProductModal');
            if (oldModal) oldModal.remove();
            // Chu·∫©n b·ªã d·ªØ li·ªáu ·∫£nh
            let imagesArr = [];
            if (product.images && Array.isArray(product.images)) {
                imagesArr = product.images;
            } else if (product.image) {
                imagesArr = [product.image];
            } else {
                imagesArr = [''];
            }
            // T·∫°o modal m·ªõi
            const modal = document.createElement('div');
            modal.id = 'dynamicProductModal';
            modal.className = 'modal';
            modal.style.display = 'block';
            // H√†m render c√°c √¥ input ·∫£nh
            function renderImageInputs() {
                return imagesArr.map((img, idx) => `
                    <div style='display:flex;gap:8px;margin-bottom:6px;'>
                        <input type="text" class="form-input image-input" name="images" value="${img}" placeholder="Link ·∫£nh ${idx+1}" required style="flex:1;">
                        ${imagesArr.length > 1 ? `<button type='button' class='btn' style='background:#ef4444;color:white;padding:4px 10px;' onclick='this.parentNode.remove();window._removeImageAt(${idx})'>X</button>` : ''}
                    </div>
                `).join('');
            }
            // H√†m th√™m ·∫£nh
            window._addImageInput = function() {
                imagesArr.push('');
                showProductModal({ ...product, images: imagesArr });
            };
            // H√†m x√≥a ·∫£nh
            window._removeImageAt = function(idx) {
                imagesArr.splice(idx, 1);
                showProductModal({ ...product, images: imagesArr });
            };
            modal.innerHTML = `
                <div class="modal-content">
                    <span class="close" onclick="document.getElementById('dynamicProductModal').remove()">&times;</span>
                    <h2>${product.id ? 'S·ª≠a s·∫£n ph·∫©m' : 'Th√™m s·∫£n ph·∫©m m·ªõi'}</h2>
                    <form id="dynamicProductForm">
                        <div class="form-group">
                            <label class="form-label">T√™n s·∫£n ph·∫©m</label>
                            <input type="text" class="form-input" name="name" value="${product.name || ''}" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Th∆∞∆°ng hi·ªáu</label>
                            <select class="form-input" name="brand" required>
                                <option value="">Ch·ªçn th∆∞∆°ng hi·ªáu</option>
                                <option value="Nike" ${product.brand === 'Nike' ? 'selected' : ''}>Nike</option>
                                <option value="Puma" ${product.brand === 'Puma' ? 'selected' : ''}>Puma</option>
                                <option value="Adidas" ${product.brand === 'Adidas' ? 'selected' : ''}>Adidas</option>
                                <option value="Vans" ${product.brand === 'Vans' ? 'selected' : ''}>Vans</option>
                                <option value="FILA" ${product.brand === 'FILA' ? 'selected' : ''}>FILA</option>
                                <option value="Red Tape" ${product.brand === 'Red Tape' ? 'selected' : ''}>Red Tape</option>
                                <option value="Under Armour" ${product.brand === 'Under Armour' ? 'selected' : ''}>Under Armour</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">·∫¢nh s·∫£n ph·∫©m (c√≥ th·ªÉ nh·∫≠p nhi·ªÅu link, m·ªói link 1 √¥)</label>
                            <div id="images-list">${renderImageInputs()}</div>
                            <button type="button" class="btn btn-primary" style="margin-top:8px;" onclick="window._addImageInput()">+ Th√™m ·∫£nh</button>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Gi√° (VND)</label>
                            <input type="number" class="form-input" name="price" value="${product.price || ''}" placeholder="Nh·∫≠p gi√° s·∫£n ph·∫©m" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Gi√° c≈© (VND)</label>
                            <input type="number" class="form-input" name="oldPrice" value="${product.oldPrice || ''}" placeholder="Gi√° c≈© (kh√¥ng b·∫Øt bu·ªôc)">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ƒê√°nh gi√°</label>
                            <input type="number" class="form-input" name="rating" value="${product.rating || '4.5'}" min="0" max="5" step="0.1" placeholder="ƒê√°nh gi√° t·ª´ 0-5">
                        </div>
                        <div class="form-group">
                            <label class="form-label">S·ªë ƒë√°nh gi√°</label>
                            <input type="number" class="form-input" name="reviews" value="${product.reviews || '100'}" placeholder="S·ªë l∆∞·ª£ng ƒë√°nh gi√°">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Gi·∫£m gi√° (%)</label>
                            <input type="number" class="form-input" name="discount" value="${product.discount || '0'}" min="0" max="100" placeholder="Ph·∫ßn trƒÉm gi·∫£m gi√°">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ƒê√£ b√°n</label>
                            <input type="number" class="form-input" name="sold" value="${product.sold || '0'}" placeholder="S·ªë l∆∞·ª£ng ƒë√£ b√°n">
                        </div>
                        <div class="form-group">
                            <label class="form-label">M√¥ t·∫£</label>
                            <textarea class="form-input" name="description" rows="3" placeholder="M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m">${product.description || ''}</textarea>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width:100%;margin-bottom:10px;">${product.id ? 'C·∫≠p nh·∫≠t' : 'Th√™m s·∫£n ph·∫©m'}</button>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
            // ƒê√≥ng modal khi click ngo√†i
            modal.onclick = function(e) { if (e.target === modal) modal.remove(); };
            // Submit form
            document.getElementById('dynamicProductForm').onsubmit = function(e) {
                e.preventDefault();
                const form = e.target;
                // L·∫•y t·∫•t c·∫£ input ·∫£nh
                const imageInputs = form.querySelectorAll('.image-input');
                const images = Array.from(imageInputs).map(input => input.value).filter(Boolean);
                const data = {
                    name: form.name.value,
                    brand: form.brand.value,
                    images: images,
                    image: images[0] && images[0].startsWith('http') ? images[0] : (images[0] || ''), // n·∫øu l√† URL th√¨ gi·ªØ nguy√™n, n·∫øu l√† t√™n file th√¨ gi·ªØ t√™n file
                    price: Number(form.price.value) || 0,
                    oldPrice: Number(form.oldPrice.value) || 0,
                    rating: Number(form.rating.value) || 4.5,
                    reviews: Number(form.reviews.value) || 100,
                    discount: Number(form.discount.value) || 0,
                    sold: Number(form.sold.value) || 0,
                    description: form.description.value
                };
                if (product.id) {
                    fetch(`${API_URL}/products/${product.id}`, {
                        method: 'PATCH', // ƒê·ªïi t·ª´ PUT sang PATCH ƒë·ªÉ backend nh·∫≠n ƒë∆∞·ª£c
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ ...product, ...data })
                    }).then(() => {
                        showNotification('ƒê√£ c·∫≠p nh·∫≠t s·∫£n ph·∫©m!', 'success');
                        modal.remove();
                        fetchAndRenderProducts();
                    });
                } else {
                    fetch(`${API_URL}/products`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    }).then(() => {
                        showNotification('ƒê√£ th√™m s·∫£n ph·∫©m!', 'success');
                        modal.remove();
                        fetchAndRenderProducts();
                    });
                }
            };
        }
        // G√°n l·∫°i n√∫t th√™m s·∫£n ph·∫©m
        const addProductBtns = document.querySelectorAll('button[onclick*="addProductModal"]');
        addProductBtns.forEach(btn => btn.onclick = openAddProductModal);
        // Modal ƒë·ªông qu·∫£n l√Ω bi·∫øn th·ªÉ
        function showVariantModal(product, variants) {
            let oldModal = document.getElementById('dynamicVariantModal');
            if (oldModal) oldModal.remove();
            const modal = document.createElement('div');
            modal.id = 'dynamicVariantModal';
            modal.className = 'modal';
            modal.style.display = 'block';
            let variantRows = variants.map(variant => `
                <tr>
                    <td>${variant.size}</td>
                    <td><span style="display:inline-block;width:22px;height:22px;border-radius:50%;background:${variant.color};border:1.5px solid #ccc;vertical-align:middle;margin-right:6px;"></span>${variant.color}</td>
                    <td>${variant.price}</td>
                    <td>${variant.stock}</td>
                    <td>
                        <button class="btn" style="background:#10b981;color:white;margin-right:5px;" onclick="editVariant('${variant.id}', '${product.id}')">S·ª≠a</button>
                        <button class="btn" style="background:#ef4444;color:white;" onclick="deleteVariant('${variant.id}', '${product.id}')">X√≥a</button>
                    </td>
                </tr>
            `).join('');
            modal.innerHTML = `
                <div class="modal-content">
                    <span class="close" onclick="document.getElementById('dynamicVariantModal').remove()">&times;</span>
                    <h2>Bi·∫øn th·ªÉ cho: ${product.name}</h2>
                    <table class="table">
                        <thead><tr><th>Size</th><th>M√†u</th><th>Gi√°</th><th>T·ªìn kho</th><th>Thao t√°c</th></tr></thead>
                        <tbody>${variantRows}</tbody>
                    </table>
                    <button class="btn btn-primary" style="width:100%;margin-top:10px;" onclick="addVariant('${product.id}')">Th√™m bi·∫øn th·ªÉ</button>
                </div>
            `;
            document.body.appendChild(modal);
            modal.onclick = function(e) { if (e.target === modal) modal.remove(); };
        }
        // Th√™m bi·∫øn th·ªÉ
        window.addVariant = function(productId) {
            let oldModal = document.getElementById('addVariantModal');
            if (oldModal) oldModal.remove();
            const modal = document.createElement('div');
            modal.id = 'addVariantModal';
            modal.className = 'modal';
            modal.style.display = 'block';
            // 7 m√†u c∆° b·∫£n
            const colorOptions = [
              { name: 'Black', code: '#000000' },
              { name: 'White', code: '#ffffff' },
              { name: 'Red', code: '#ff0000' },
              { name: 'Blue', code: '#0000ff' },
              { name: 'Yellow', code: '#ffff00' },
              { name: 'Green', code: '#00ff00' },
              { name: 'Orange', code: '#ffa500' },
            ];
            const sizeOptions = [36,37,38,39,40,41,42,43,44,45];
            modal.innerHTML = `
                <div class="modal-content">
                    <span class="close" onclick="document.getElementById('addVariantModal').remove()">&times;</span>
                    <h2>Th√™m nhi·ªÅu bi·∫øn th·ªÉ</h2>
                    <form id="matrixVariantForm">
                        <div class="form-group">
                          <label class="form-label">Ch·ªçn size</label>
                          <div style="display:flex;flex-wrap:wrap;gap:8px;">
                            ${sizeOptions.map(s => `<label style='display:flex;align-items:center;gap:4px;'><input type='checkbox' name='sizes' value='${s}'/>${s}</label>`).join('')}
                          </div>
                        </div>
                        <div class="form-group">
                          <label class="form-label">Ch·ªçn m√†u</label>
                          <div style="display:flex;flex-wrap:wrap;gap:8px;">
                            ${colorOptions.map(c => `<label style='display:flex;align-items:center;gap:4px;'><input type='checkbox' name='colors' value='${c.code}'/><span style='display:inline-block;width:18px;height:18px;border-radius:50%;background:${c.code};border:1.5px solid #ccc;vertical-align:middle;'></span>${c.name}</label>`).join('')}
                          </div>
                        </div>
                        <div class="form-group">
                          <label class="form-label">Gi√° m·∫∑c ƒë·ªãnh</label>
                          <input type="number" class="form-input" name="price" placeholder="Gi√° cho t·∫•t c·∫£ bi·∫øn th·ªÉ" required>
                        </div>
                        <div class="form-group">
                          <label class="form-label">T·ªìn kho m·∫∑c ƒë·ªãnh</label>
                          <input type="number" class="form-input" name="stock" placeholder="T·ªìn kho cho t·∫•t c·∫£ bi·∫øn th·ªÉ" required>
                        </div>
                        <button type="button" class="btn btn-primary" style="width:100%;margin-bottom:10px;" id="previewVariantsBtn">T·∫°o bi·∫øn th·ªÉ</button>
                    </form>
                    <div id="matrixPreviewBox"></div>
                </div>
            `;
            document.body.appendChild(modal);
            modal.onclick = function(e) { if (e.target === modal) modal.remove(); };
            // X·ª≠ l√Ω preview b·∫£ng bi·∫øn th·ªÉ
            document.getElementById('previewVariantsBtn').onclick = function() {
              const form = document.getElementById('matrixVariantForm');
              const sizes = Array.from(form.querySelectorAll('input[name="sizes"]:checked')).map(i=>Number(i.value));
              const colors = Array.from(form.querySelectorAll('input[name="colors"]:checked')).map(i=>i.value);
              const price = Number(form.price.value);
              const stock = Number(form.stock.value);
              if(sizes.length===0 || colors.length===0) {
                alert('Vui l√≤ng ch·ªçn √≠t nh·∫•t 1 size v√† 1 m√†u!');
                return;
              }
              // Sinh t·ªï h·ª£p
              let variants = [];
              sizes.forEach(size => {
                colors.forEach(color => {
                  variants.push({ size, color, price, stock });
                });
              });
              // Hi·ªÉn th·ªã b·∫£ng preview
              let html = `<form id='saveVariantsForm'><table class='table' style='margin-top:12px;'>
                <thead><tr><th>Size</th><th>M√†u</th><th>Gi√°</th><th>T·ªìn kho</th><th>X√≥a</th></tr></thead><tbody>`;
              variants.forEach((v, idx) => {
                html += `<tr>
                  <td><input type='hidden' name='size' value='${v.size}'/>${v.size}</td>
                  <td><input type='hidden' name='color' value='${v.color}'/><span style='display:inline-block;width:22px;height:22px;border-radius:50%;background:${v.color};border:1.5px solid #ccc;vertical-align:middle;margin-right:6px;'></span>${colorOptions.find(c=>c.code===v.color)?.name||v.color}</td>
                  <td><input type='number' name='price' value='${v.price}' style='width:80px;'/></td>
                  <td><input type='number' name='stock' value='${v.stock}' style='width:60px;'/></td>
                  <td><button type='button' class='remove-variant-btn' data-idx='${idx}' style='color:#e53935;font-weight:bold;background:none;border:none;font-size:18px;'>√ó</button></td>
                </tr>`;
              });
              html += `</tbody></table>
              <button type='submit' class='btn btn-primary' style='width:100%;margin-top:10px;'>L∆∞u t·∫•t c·∫£ bi·∫øn th·ªÉ</button></form>`;
              document.getElementById('matrixPreviewBox').innerHTML = html;
              // X·ª≠ l√Ω x√≥a d√≤ng
              document.querySelectorAll('.remove-variant-btn').forEach(btn => {
                btn.onclick = function() {
                  variants.splice(Number(btn.dataset.idx),1);
                  document.getElementById('previewVariantsBtn').onclick(); // render l·∫°i
                }
              });
              // X·ª≠ l√Ω l∆∞u t·∫•t c·∫£ bi·∫øn th·ªÉ
              document.getElementById('saveVariantsForm').onsubmit = function(e) {
                e.preventDefault();
                const rows = Array.from(document.querySelectorAll('#saveVariantsForm tbody tr'));
                const data = rows.map(row => {
                  const size = Number(row.querySelector('input[name="size"]').value);
                  const color = row.querySelector('input[name="color"]').value;
                  const price = Number(row.querySelector('input[name="price"]').value);
                  const stock = Number(row.querySelector('input[name="stock"]').value);
                  return { productId, size, color, price, stock };
                });
                Promise.all(data.map(variant => fetch(`${API_URL}/variants`, {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify(variant)
                }))).then(() => {
                  showNotification('ƒê√£ th√™m c√°c bi·∫øn th·ªÉ!', 'success');
                  modal.remove();
                  openVariantModal(productId);
                });
              };
            };
        };
        // S·ª≠a bi·∫øn th·ªÉ
        window.editVariant = function(variantId, productId) {
            fetch(`${API_URL}/variants/${variantId}`)
                .then(res => res.json())
                .then(variant => {
                    let oldModal = document.getElementById('editVariantModal');
                    if (oldModal) oldModal.remove();
                    const modal = document.createElement('div');
                    modal.id = 'editVariantModal';
                    modal.className = 'modal';
                    modal.style.display = 'block';
                    // 7 m√†u c∆° b·∫£n
                    const colorOptions = [
                      { name: 'Black', code: '#000000' },
                      { name: 'White', code: '#ffffff' },
                      { name: 'Red', code: '#ff0000' },
                      { name: 'Blue', code: '#0000ff' },
                      { name: 'Yellow', code: '#ffff00' },
                      { name: 'Green', code: '#00ff00' },
                      { name: 'Orange', code: '#ffa500' },
                    ];
                    modal.innerHTML = `
                        <div class="modal-content">
                            <span class="close" onclick="document.getElementById('editVariantModal').remove()">&times;</span>
                            <h2>S·ª≠a bi·∫øn th·ªÉ</h2>
                            <form id="editVariantForm">
                                <div class="form-group">
                                  <label class="form-label">Size</label>
                                  <select class="form-input" name="size" required>
                                    <option value="">Ch·ªçn size</option>
                                    ${[36,37,38,39,40,41,42,43,44,45].map(s => `<option value="${s}" ${variant.size==s?'selected':''}>${s}</option>`).join('')}
                                  </select>
                                </div>
                                <div class="form-group">
                                  <label class="form-label">M√†u</label>
                                  <select class="form-input" name="color" id="editVariantColorSelect" required>
                                    <option value="">Ch·ªçn m√†u</option>
                                    ${colorOptions.map(c => `<option value="${c.code}" data-name="${c.name}" ${variant.color?.toLowerCase()===c.code?'selected':''}>${c.name}</option>`).join('')}
                                  </select>
                                  <div id="editColorPreview" style="margin-top:8px;"></div>
                                </div>
                                <div class="form-group"><label class="form-label">Gi√°</label><input type="number" class="form-input" name="price" value="${variant.price}" required></div>
                                <div class="form-group"><label class="form-label">T·ªìn kho</label><input type="number" class="form-input" name="stock" value="${variant.stock}" required></div>
                                <button type="submit" class="btn btn-primary" style="width:100%;">C·∫≠p nh·∫≠t bi·∫øn th·ªÉ</button>
                            </form>
                        </div>
                    `;
                    document.body.appendChild(modal);
                    modal.onclick = function(e) { if (e.target === modal) modal.remove(); };
                    // Preview m√†u
                    const colorSelect = modal.querySelector('#editVariantColorSelect');
                    const colorPreview = modal.querySelector('#editColorPreview');
                    colorSelect.onchange = function() {
                      const val = colorSelect.value;
                      const name = colorSelect.options[colorSelect.selectedIndex]?.text || '';
                      if(val) {
                        colorPreview.innerHTML = `<span style='display:inline-block;width:28px;height:28px;border-radius:50%;background:${val};border:1.5px solid #ccc;vertical-align:middle;margin-right:8px;'></span><span style='vertical-align:middle;'>${name}</span>`;
                      } else {
                        colorPreview.innerHTML = '';
                      }
                    };
                    // Hi·ªÉn th·ªã preview m√†u ban ƒë·∫ßu
                    if(variant.color) {
                      const c = colorOptions.find(c=>c.code===variant.color.toLowerCase());
                      if(c) colorPreview.innerHTML = `<span style='display:inline-block;width:28px;height:28px;border-radius:50%;background:${c.code};border:1.5px solid #ccc;vertical-align:middle;margin-right:8px;'></span><span style='vertical-align:middle;'>${c.name}</span>`;
                    }
                    document.getElementById('editVariantForm').onsubmit = function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            size: Number(form.size.value),
                            color: form.color.value, // lu√¥n l√† m√£ hex
                            price: Number(form.price.value),
                            stock: Number(form.stock.value)
                        };
                        fetch(`${API_URL}/variants/${variantId}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ ...variant, ...data })
                        }).then(() => {
                            showNotification('ƒê√£ c·∫≠p nh·∫≠t bi·∫øn th·ªÉ!', 'success');
                            modal.remove();
                            openVariantModal(productId);
                        });
                    };
                });
        };
        // X√≥a bi·∫øn th·ªÉ
        window.deleteVariant = function(variantId, productId) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a bi·∫øn th·ªÉ n√†y?')) return;
            fetch(`${API_URL}/variants/${variantId}`, { method: 'DELETE' })
                .then(() => {
                    showNotification('ƒê√£ x√≥a bi·∫øn th·ªÉ!', 'success');
                    openVariantModal(productId);
                });
        };

        // ========== CRUD BANNER ========== //
        function fetchAndRenderBanners() {
            fetch(`${API_URL}/banners`)
                .then(res => res.json())
                .then(banners => {
                    const tbody = document.querySelector('#bannerTable tbody');
                    tbody.innerHTML = '';
                    banners.forEach(banner => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td><img src="${banner.image}" style="width:60px;height:32px;object-fit:cover;border-radius:6px;"/></td>
                            <td>${banner.title}</td>
                            <td><a href="${banner.link}" target="_blank">${banner.link}</a></td>
                            <td>
                                <button class="btn" style="background:#10b981;color:white;" onclick="openBannerModal(${banner.id})">S·ª≠a</button>
                                <button class="btn" style="background:#ef4444;color:white;" onclick="deleteBanner(${banner.id})">X√≥a</button>
                            </td>
                        `;
                        tbody.appendChild(tr);
                    });
                })
                .catch(error => {
                    console.error('Error fetching banners:', error);
                    showNotification('L·ªói khi t·∫£i banner!', 'error');
                });
        }

        document.querySelector('a[href="#banners"]').addEventListener('click', fetchAndRenderBanners);

        function openBannerModal(id) {
            const modal = document.getElementById('bannerModal');
            const form = document.getElementById('bannerForm');
            document.getElementById('bannerModalTitle').textContent = id ? 'S·ª≠a banner' : 'Th√™m banner';
            if (id) {
                fetch(`${API_URL}/banners/${id}`)
                    .then(res => res.json())
                    .then(banner => {
                        form.title.value = banner.title;
                        form.link.value = banner.link;
                        form.image.value = banner.image;
                        form.dataset.id = id;
                        modal.style.display = 'block';
                    })
                    .catch(error => {
                        console.error('Error fetching banner:', error);
                        showNotification('L·ªói khi t·∫£i banner!', 'error');
                    });
            } else {
                form.title.value = '';
                form.link.value = '';
                form.image.value = '';
                form.dataset.id = '';
                modal.style.display = 'block';
            }
        }

        document.getElementById('bannerForm').onsubmit = function(e) {
            e.preventDefault();
            const form = e.target;
            const data = {
                title: form.title.value,
                link: form.link.value,
                image: form.image.value
            };
            const id = form.dataset.id;
            if (id) {
                fetch(`${API_URL}/banners/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(() => {
                    closeModal('bannerModal');
                    fetchAndRenderBanners();
                    showNotification('ƒê√£ c·∫≠p nh·∫≠t banner!', 'success');
                })
                .catch(error => {
                    console.error('Error updating banner:', error);
                    showNotification('L·ªói khi c·∫≠p nh·∫≠t banner!', 'error');
                });
            } else {
                fetch(`${API_URL}/banners`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(() => {
                    closeModal('bannerModal');
                    fetchAndRenderBanners();
                    showNotification('ƒê√£ th√™m banner!', 'success');
                })
                .catch(error => {
                    console.error('Error adding banner:', error);
                    showNotification('L·ªói khi th√™m banner!', 'error');
                });
            }
        };

        function deleteBanner(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a banner n√†y?')) return;
            fetch(`${API_URL}/banners/${id}`, { method: 'DELETE' })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(() => {
                    fetchAndRenderBanners();
                    showNotification('ƒê√£ x√≥a banner!', 'success');
                })
                .catch(error => {
                    console.error('Error deleting banner:', error);
                    showNotification('L·ªói khi x√≥a banner!', 'error');
                });
        }

        // ========== CRUD NOTIFICATIONS ========== //
        function fetchAndRenderNotifications() {
          fetch(`${API_URL}/notifications`).then(res => res.json()).then(notifications => {
            const tbody = document.querySelector('#notificationTable tbody');
            tbody.innerHTML = '';
            notifications.forEach(n => {
              const tr = document.createElement('tr');
              tr.innerHTML = `
                <td>${n.title}</td>
                <td>${n.content}</td>
                <td>${n.userId ? n.userId : 'T·∫•t c·∫£'}</td>
                <td>${n.createdAt ? new Date(n.createdAt).toLocaleString('vi-VN') : ''}</td>
                <td>
                  <button class="btn" style="background:#10b981;color:white;" onclick="openNotificationModal(${n.id})">S·ª≠a</button>
                  <button class="btn" style="background:#ef4444;color:white;" onclick="deleteNotification(${n.id})">X√≥a</button>
                </td>
              `;
              tbody.appendChild(tr);
            });
          });
        }
        document.querySelector('a[href="#notifications"]').addEventListener('click', fetchAndRenderNotifications);
        function openNotificationModal(id) {
          const modal = document.getElementById('notificationModal');
          const form = document.getElementById('notificationForm');
          document.getElementById('notificationModalTitle').textContent = id ? 'S·ª≠a th√¥ng b√°o' : 'Th√™m th√¥ng b√°o';
          if (id) {
            fetch(`${API_URL}/notifications/${id}`).then(res => res.json()).then(n => {
              form.title.value = n.title;
              form.content.value = n.content;
              form.userId.value = n.userId || '';
              form.dataset.id = id;
              modal.style.display = 'block';
            });
          } else {
            form.title.value = '';
            form.content.value = '';
            form.userId.value = '';
            form.dataset.id = '';
            modal.style.display = 'block';
          }
        }
        document.getElementById('notificationForm').onsubmit = function(e) {
          e.preventDefault();
          const form = e.target;
          const data = {
            title: form.title.value,
            content: form.content.value,
            userId: form.userId.value ? Number(form.userId.value) : null,
            createdAt: new Date().toISOString()
          };
          const id = form.dataset.id;
          if (id) {
            fetch(`${API_URL}/notifications/${id}`, {
              method: 'PUT',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(data)
            }).then(() => {
              closeModal('notificationModal');
              fetchAndRenderNotifications();
              showNotification('ƒê√£ c·∫≠p nh·∫≠t th√¥ng b√°o!', 'success');
            });
          } else {
            fetch(`${API_URL}/notifications`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(data)
            }).then(() => {
              closeModal('notificationModal');
              fetchAndRenderNotifications();
              showNotification('ƒê√£ th√™m th√¥ng b√°o!', 'success');
            });
          }
        };
        function deleteNotification(id) {
          if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a th√¥ng b√°o n√†y?')) return;
          fetch(`${API_URL}/notifications/${id}`, { method: 'DELETE' }).then(() => {
            fetchAndRenderNotifications();
            showNotification('ƒê√£ x√≥a th√¥ng b√°o!', 'success');
          });
        }

        // ========== CRUD INVENTORY ========== //
        function fetchAndRenderInventory() {
            fetch(`${API_URL}/inventory`)
                .then(res => res.json())
                .then(inventory => {
                    const tbody = document.querySelector('#inventoryTable tbody');
                    tbody.innerHTML = '';
                    inventory.forEach(item => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${item.productName}</td>
                            <td>${item.sku}</td>
                            <td>${item.color}</td>
                            <td>${item.size}</td>
                            <td>${item.quantity}</td>
                            <td><span class="status-badge ${item.status === 'In Stock' ? 'status-active' : item.status === 'Out of Stock' ? 'status-pending' : 'status-inactive'}">${item.status}</span></td>
                            <td>
                                <button class="btn" style="background:#10b981;color:white;" onclick="openInventoryEditModal(${item.id})">S·ª≠a</button>
                                <button class="btn" style="background:#ef4444;color:white;" onclick="deleteInventory(${item.id})">X√≥a</button>
                            </td>
                        `;
                        tbody.appendChild(tr);
                    });
                });
        }

        document.querySelector('a[href="#inventory"]').addEventListener('click', fetchAndRenderInventory);

        function openInventoryEditModal(id) {
            fetch(`${API_URL}/inventory/${id}`)
                .then(res => res.json())
                .then(item => {
                    document.getElementById('editProductName').value = item.productName;
                    document.getElementById('editSKU').value = item.sku;
                    document.getElementById('editColor').value = item.color;
                    document.getElementById('editSize').value = item.size;
                    document.getElementById('editQuantity').value = item.quantity;
                    document.getElementById('inventoryEditModal').style.display = 'block';
                });
        }

        function deleteInventory(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a m·ª•c n√†y?')) return;
            fetch(`${API_URL}/inventory/${id}`, { method: 'DELETE' })
                .then(() => {
                    fetchAndRenderInventory();
                    showNotification('ƒê√£ x√≥a m·ª•c!', 'success');
                });
        }

        document.getElementById('inventoryEditForm').onsubmit = function(e) {
            e.preventDefault();
            const form = e.target;
            const data = {
                productName: form.productName.value,
                sku: form.sku.value,
                color: form.color.value,
                size: form.size.value,
                quantity: Number(form.quantity.value),
                status: form.status.value
            };
            const id = form.dataset.id;
            if (id) {
                fetch(`${API_URL}/inventory/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(() => {
                    closeModal('inventoryEditModal');
                    fetchAndRenderInventory();
                    showNotification('ƒê√£ c·∫≠p nh·∫≠t m·ª•c!', 'success');
                })
                .catch(error => {
                    console.error('Error updating inventory:', error);
                    showNotification('L·ªói khi c·∫≠p nh·∫≠t m·ª•c!', 'error');
                });
            } else {
                fetch(`${API_URL}/inventory`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(() => {
                    closeModal('inventoryEditModal');
                    fetchAndRenderInventory();
                    showNotification('ƒê√£ th√™m m·ª•c!', 'success');
                })
                .catch(error => {
                    console.error('Error adding inventory:', error);
                    showNotification('L·ªói khi th√™m m·ª•c!', 'error');
                });
            }
        };

        // ========== CRUD ƒê∆†N H√ÄNG ========== //
        function fetchAndRenderOrders() {
            console.log('Fetching orders from:', `${API_URL}/orders`);
            // L·∫•y danh s√°ch ƒë∆°n h√†ng v√† users ƒë·ªÉ map th√¥ng tin
            Promise.all([
                fetch(`${API_URL}/orders`).then(res => {
                    console.log('Orders response status:', res.status);
                    return res.json();
                }),
                fetch(`${API_URL}/users`).then(res => {
                    console.log('Users response status:', res.status);
                    return res.json();
                })
            ])
            .then(([orders, users]) => {
                console.log('Orders data:', orders);
                console.log('Users data:', users);
                const tbody = document.querySelector('#ordersTable tbody');
                if (!tbody) {
                    console.error('Orders table tbody not found!');
                    return;
                }
                tbody.innerHTML = '';
                
                orders.forEach(order => {
                        // T√¨m th√¥ng tin user
                        const user = users.find(u => u.id === order.userId);
                        const userName = user ? user.name : `User ${order.userId}`;
                        
                        // T√≠nh ph√≠ ship
                        const shippingFee = order.shipping || 0;
                        const productTotal = order.total - shippingFee;
                        
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>#${order.id}</td>
                            <td>${userName}</td>
                            <td>${order.createdAt ? new Date(order.createdAt).toLocaleDateString('vi-VN') : ''}</td>
                            <td>
                                <div style="font-size: 12px;">
                                    <div>H√†ng: ${productTotal.toLocaleString()} VND</div>
                                    <div style="color: #666;">Ship: ${shippingFee.toLocaleString()} VND</div>
                                    <div style="font-weight: bold; color: #667eea;">T·ªïng: ${order.total ? order.total.toLocaleString() + ' VND' : '-'}</div>
                                </div>
                            </td>
                            <td><span class="status-badge" style="background-color: ${order.statusColor || STATUS_COLORS[order.status] || '#6b7280'}; color: white;">${order.status}</span></td>
                            <td>
                                <button class="btn" style="background: #3b82f6; color: white; margin-right: 5px;" onclick="viewOrderDetail('${order.id}')">Xem</button>
                                <button class="btn" style="background: #f59e0b; color: white;" onclick="openUpdateOrderModal('${order.id}', '${order.status}')" ${ORDER_STATUS_FLOW[order.status]?.length === 0 ? 'disabled' : ''}>C·∫≠p nh·∫≠t</button>
                            </td>
                        `;
                        tbody.appendChild(tr);
                    });
            })
            .catch(error => {
                console.error('Error fetching orders:', error);
                showNotification('L·ªói khi t·∫£i danh s√°ch ƒë∆°n h√†ng!', 'error');
            });
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™
        function updateStats() {
            Promise.all([
                fetch(`${API_URL}/products`).then(res => res.json()),
                fetch(`${API_URL}/orders`).then(res => res.json()),
                fetch(`${API_URL}/users`).then(res => res.json())
            ]).then(([products, orders, users]) => {
                document.getElementById('totalProducts').textContent = products.length;
                document.getElementById('totalUsers').textContent = users.length;
                
                // T√≠nh t·ªïng doanh thu
                const totalRevenue = orders.reduce((sum, order) => sum + (order.total || 0), 0);
                document.getElementById('totalRevenue').textContent = totalRevenue.toLocaleString() + ' VND';
                
                // ƒê·∫øm ƒë∆°n h√†ng m·ªõi (tr·∫°ng th√°i "Ch·ªù x√°c nh·∫≠n")
                const newOrders = orders.filter(order => order.status === 'Ch·ªù x√°c nh·∫≠n').length;
                const newOrdersElement = document.getElementById('newOrders');
                if (newOrdersElement) {
                    newOrdersElement.textContent = newOrders;
                    if (newOrders > 0) {
                        newOrdersElement.style.color = '#ef4444';
                        newOrdersElement.style.fontWeight = 'bold';
                    } else {
                        newOrdersElement.style.color = '#10b981';
                    }
                }

                // Th·ªëng k√™ tr·∫°ng th√°i ƒë∆°n h√†ng v·ªõi m√†u s·∫Øc
                const statusCounts = {};
                orders.forEach(order => {
                    statusCounts[order.status] = (statusCounts[order.status] || 0) + 1;
                });

                const orderStatusStatsElement = document.getElementById('orderStatusStats');
                if (orderStatusStatsElement) {
                    let statsHtml = '';
                    Object.keys(STATUS_COLORS).forEach(status => {
                        const count = statusCounts[status] || 0;
                        const color = STATUS_COLORS[status];
                        statsHtml += `
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px; background: rgba(255,255,255,0.8); border-radius: 10px; border-left: 4px solid ${color};">
                                <div>
                                    <div style="font-weight: bold; color: #333; margin-bottom: 4px;">${status}</div>
                                    <div style="font-size: 12px; color: #666;">${count} ƒë∆°n h√†ng</div>
                                </div>
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: ${color}; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 14px;">
                                    ${count}
                                </div>
                            </div>
                        `;
                    });
                    orderStatusStatsElement.innerHTML = statsHtml;
                }
            }).catch(error => {
                console.error('Error updating stats:', error);
            });
        }

        // G·ªçi khi v√†o tab ƒë∆°n h√†ng
        const orderTab = document.querySelector('a[href="#orders"]');
        if (orderTab) {
            orderTab.addEventListener('click', fetchAndRenderOrders);
        }

        // Load ƒë∆°n h√†ng khi trang ƒë∆∞·ª£c load (n·∫øu ƒëang ·ªü tab orders)
        if (window.location.hash === '#orders') {
            fetchAndRenderOrders();
        }
        
        // M√†u s·∫Øc m·∫∑c ƒë·ªãnh cho tr·∫°ng th√°i
        let STATUS_COLORS = {
          'Ch·ªù x√°c nh·∫≠n': '#f59e0b',
          'Ch·ªù l·∫•y h√†ng': '#6366f1',
          'ƒêang giao h√†ng': '#3b82f6',
          'ƒê√£ giao h√†ng': '#10b981',
          'ƒê√£ hu·ª∑': '#ef4444'
        };

        // L·∫•y m√†u s·∫Øc t·ª´ backend
        async function fetchStatusColors() {
          try {
            const response = await fetch(`${API_URL}/order-status-colors`);
            const colors = await response.json();
            STATUS_COLORS = { ...STATUS_COLORS, ...colors };
          } catch (error) {
            console.log('Kh√¥ng th·ªÉ l·∫•y m√†u s·∫Øc t·ª´ backend, s·ª≠ d·ª•ng m√†u m·∫∑c ƒë·ªãnh');
          }
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™ khi load trang
        updateStats();
        
        // L·∫•y m√†u s·∫Øc t·ª´ backend
        fetchStatusColors();

        // Th√™m mapping flow tr·∫°ng th√°i
        const ORDER_STATUS_FLOW = {
          'Ch·ªù x√°c nh·∫≠n': [
            { next: 'Ch·ªù l·∫•y h√†ng', label: 'X√°c nh·∫≠n' },
            { next: 'ƒê√£ hu·ª∑', label: 'Hu·ª∑ ƒë∆°n' }
          ],
          'Ch·ªù l·∫•y h√†ng': [
            { next: 'ƒêang giao h√†ng', label: 'ƒê√£ l·∫•y h√†ng' },
            { next: 'ƒê√£ hu·ª∑', label: 'Hu·ª∑ ƒë∆°n' }
          ],
          'ƒêang giao h√†ng': [
            { next: 'ƒê√£ giao h√†ng', label: 'ƒê√£ giao h√†ng' },
            { next: 'ƒê√£ hu·ª∑', label: 'Hu·ª∑ ƒë∆°n' }
          ],
          'ƒê√£ giao h√†ng': [],
          'ƒê√£ hu·ª∑': []
        };

        // Th√™m modal c·∫≠p nh·∫≠t tr·∫°ng th√°i
        function openUpdateOrderModal(orderId, currentStatus) {
          const flow = ORDER_STATUS_FLOW[currentStatus] || [];
          if (flow.length === 0) {
            alert('ƒê∆°n h√†ng ƒë√£ ho√†n th√†nh ho·∫∑c ƒë√£ hu·ª∑, kh√¥ng th·ªÉ c·∫≠p nh·∫≠t!');
            return;
          }
          let html = `<div class='modal' id='updateOrderModal' style='display:block;'>
            <div class='modal-content' style='max-width:400px;'>
              <span class='close' onclick='document.getElementById("updateOrderModal").remove()'>&times;</span>
              <h2>C·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng</h2>
              <div style='margin:16px 0;'>
                <b>Tr·∫°ng th√°i hi·ªán t·∫°i:</b> <span style='background-color: ${STATUS_COLORS[currentStatus] || '#6b7280'}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;'>${currentStatus}</span>
              </div>
              <div style='display:flex;flex-direction:column;gap:12px;'>`;
          flow.forEach(opt => {
            const nextStatusColor = STATUS_COLORS[opt.next] || '#6b7280';
            html += `<button class='btn' style='background:${nextStatusColor};color:#fff;font-weight:bold;' onclick='updateOrderStatusWithValue("${orderId}", "${opt.next}")'>${opt.label}</button>`;
          });
          html += `</div></div></div>`;
          document.body.insertAdjacentHTML('beforeend', html);
        }

        // H√†m g·ªçi API c·∫≠p nh·∫≠t tr·∫°ng th√°i
        function updateOrderStatusWithValue(orderId, nextStatus) {
          if (!confirm(`Chuy·ªÉn tr·∫°ng th√°i ƒë∆°n h√†ng #${orderId} sang '${nextStatus}'?`)) return;
          fetch(`${API_URL}/orders/${orderId}`, {
            method: 'PATCH',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ status: nextStatus })
          })
          .then(res => res.json())
          .then(() => {
            showNotification('ƒê√£ c·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng!', 'success');
            fetchAndRenderOrders();
            document.getElementById('updateOrderModal')?.remove();
          });
        }

        // H√†m xem chi ti·∫øt ƒë∆°n h√†ng
        function viewOrderDetail(orderId) {
            Promise.all([
                fetch(`${API_URL}/orders`).then(res => res.json()),
                fetch(`${API_URL}/users`).then(res => res.json())
            ])
            .then(([orders, users]) => {
                const order = orders.find(o => o.id == orderId);
                if (!order) {
                    showNotification('Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng!', 'error');
                    return;
                }
                
                const user = users.find(u => u.id === order.userId);
                const userName = user ? user.name : `User ${order.userId}`;
                
                // T·∫°o modal hi·ªÉn th·ªã chi ti·∫øt ƒë∆°n h√†ng
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.style.display = 'block';
                
                let itemsHtml = '';
                if (order.items && order.items.length > 0) {
                    // Map m√†u s·∫Øc
                    const colorMap = {
                        'ƒëen': '#000000',
                        'tr·∫Øng': '#ffffff',
                        'ƒë·ªè': '#ff0000',
                        'xanh d∆∞∆°ng': '#0000ff',
                        'v√†ng': '#ffff00',
                        'xanh l√°': '#00ff00',
                        'cam': '#ffa500'
                    };
                    
                    itemsHtml = order.items.map(item => {
                        const colorHex = colorMap[item.color] || '#ccc';
                        const imageUrl = item.image || 'https://via.placeholder.com/60x60?text=No+Image';
                        
                        return `
                            <div style="border: 1px solid #ddd; padding: 15px; margin: 8px 0; border-radius: 12px; background: #fff;">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <img src="${imageUrl}" alt="${item.name}" style="width: 60px; height: 60px; border-radius: 8px; object-fit: cover; border: 1px solid #eee;">
                                    <div style="flex: 1;">
                                        <h4 style="margin: 0 0 8px 0; color: #333;">${item.name}</h4>
                                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                            <div style="display: flex; align-items: center; gap: 5px;">
                                                <div style="width: 20px; height: 20px; border-radius: 50%; background-color: ${colorHex}; border: 2px solid #ddd;"></div>
                                                <span style="font-weight: bold; color: #666;">${item.color}</span>
                                            </div>
                                            <span style="color: #666;">|</span>
                                            <span style="font-weight: bold; color: #666;">Size ${item.size}</span>
                                            <span style="color: #666;">|</span>
                                            <span style="font-weight: bold; color: #666;">SL: ${item.qty}</span>
                                        </div>
                                        <div style="font-size: 16px; font-weight: bold; color: #667eea;">
                                            ${item.price ? item.price.toLocaleString() + ' VND' : '-'}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
                
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 700px;">
                        <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
                        <h2>Chi ti·∫øt ƒë∆°n h√†ng #${order.id}</h2>
                        <div style="margin: 20px 0;">
                            <p><strong>Kh√°ch h√†ng:</strong> ${userName}</p>
                            <p><strong>Ng√†y ƒë·∫∑t:</strong> ${order.createdAt ? new Date(order.createdAt).toLocaleString('vi-VN') : '-'}</p>
                            <p><strong>Tr·∫°ng th√°i:</strong> <span class="status-badge" style="background-color: ${order.statusColor || STATUS_COLORS[order.status] || '#6b7280'}; color: white;">${order.status}</span></p>
                            <p><strong>Ph∆∞∆°ng th·ª©c giao h√†ng:</strong> ${order.shippingMethod || '-'}</p>
                            <p><strong>Ph∆∞∆°ng th·ª©c thanh to√°n:</strong> ${order.paymentMethod || '-'}</p>
                            <p><strong>ƒê·ªãa ch·ªâ giao h√†ng:</strong> ${order.address === 'Ch∆∞a x√°c ƒë·ªãnh' ? '<span style="color:#ef4444">Ch∆∞a x√°c ƒë·ªãnh (ƒë∆°n c≈©)</span>' : (order.address || '<span style="color:#ef4444">Ch∆∞a c√≥ th√¥ng tin</span>')}</p>
                            <p><strong>Ph√≠ giao h√†ng:</strong> ${(order.shipping === 0 ? '<span style="color:#ef4444">0 VND (ƒë∆°n c≈©)</span>' : (order.shipping != null ? order.shipping.toLocaleString() + ' VND' : '<span style=\'color:#ef4444\'>Ch∆∞a c√≥ th√¥ng tin</span>'))}</p>
                        </div>
                        <div>
                            <h3>S·∫£n ph·∫©m:</h3>
                            ${itemsHtml || '<p>Kh√¥ng c√≥ s·∫£n ph·∫©m</p>'}
                        </div>
                        <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <h4>Chi ti·∫øt thanh to√°n:</h4>
                            <p><strong>Ti·ªÅn h√†ng:</strong> ${(order.total && order.shipping != null ? (order.total - order.shipping).toLocaleString() : '-')} VND</p>
                            <p><strong>Ph√≠ giao h√†ng:</strong> ${(order.shipping != null ? order.shipping.toLocaleString() : '<span style=\'color:#ef4444\'>Ch∆∞a c√≥ th√¥ng tin</span>')} VND</p>
                            <p><strong>T·ªïng c·ªông:</strong> <strong style="color: #667eea; font-size: 18px;">${order.total ? order.total.toLocaleString() + ' VND' : '-'}</strong></p>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
            })
            .catch(error => {
                console.error('Error fetching order details:', error);
                showNotification('L·ªói khi t·∫£i chi ti·∫øt ƒë∆°n h√†ng!', 'error');
            });
        }

        // L·∫Øng nghe WebSocket ƒë·ªÉ realtime c·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng
        (function listenOrderWebSocket() {
            try {
                const ws = new WebSocket('ws://192.168.1.6:4000');
                ws.onmessage = function(event) {
                    const data = JSON.parse(event.data);
                    console.log('Admin WebSocket message:', data);
                    if (data.type === 'order_update') {
                        fetchAndRenderOrders();
                        updateStats(); // C·∫≠p nh·∫≠t th·ªëng k√™ khi c√≥ thay ƒë·ªïi
                        showNotification('ƒê∆°n h√†ng #' + data.order.id + ' ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t tr·∫°ng th√°i: ' + data.order.status, 'success');
                    } else if (data.type === 'new_order') {
                        fetchAndRenderOrders();
                        updateStats();
                        showNotification('üÜï C√≥ ƒë∆°n h√†ng m·ªõi #' + data.order.id + ' t·ª´ ' + data.customerName + '!', 'success');
                    }
                };
                ws.onopen = function() { console.log('Admin WebSocket k·∫øt n·ªëi realtime ƒë∆°n h√†ng!'); };
                ws.onerror = function(error) { console.log('Admin WebSocket l·ªói:', error); };
                ws.onclose = function() { 
                    console.log('Admin WebSocket ƒë√£ ƒë√≥ng, th·ª≠ k·∫øt n·ªëi l·∫°i...');
                    setTimeout(listenOrderWebSocket, 3000); 
                };
            } catch (e) { 
                console.log('Admin WebSocket error:', e);
                setTimeout(listenOrderWebSocket, 3000); 
            }
        })();
        
        // T·ª± ƒë·ªông refresh danh s√°ch ƒë∆°n h√†ng m·ªói 30 gi√¢y
        setInterval(() => {
            const ordersSection = document.getElementById('orders');
            if (ordersSection && ordersSection.style.display !== 'none') {
                fetchAndRenderOrders();
            }
        }, 30000);
    </script>
</body>
</html>